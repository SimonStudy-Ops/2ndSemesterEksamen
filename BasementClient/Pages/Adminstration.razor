@page "/Adminstration"
@using System.Net.Http.Json
@using System.Text.Json
@inject HttpClient Http

<h3>Adminstration</h3>

<div class="page">
<!-- liste af brugere. placeret til venstre -->
<div class="card">
    <div class="users-header">Brugere (@brugere.Count)</div>
        
    @if (loading)
    {
        <div class="muted">Henter brugere...</div>
    }
    else if (brugere.Count == 0)
    {
        <div class="muted">Ingen brugere endnu.</div>
    }
    else
    {
        @foreach (var u in brugere.OrderBy(b => b.Navn))
        {
            <div class="user-item">
                <div class="user-name">@u.Navn</div>
                <div class="muted">
                    @u.Mail <span> • </span> @u.tlfnr
                </div>
                <div class="muted">
                    <span class="badge">@((u.IsAdmin ? "Admin" : "Employee"))</span>
                    Joined @u.opretelse.ToString("yyyy-MM-dd")
                </div>
            </div>
        }
    }
</div>

<!-- Formularen for oprettelse af bruger placeret til højre -->
<div class="card">
    <div class="form-title">Opret ny bruger</div>

    @if (!string.IsNullOrWhiteSpace(fejlbesked))
    {
        <div class="error">@fejlbesked</div>
    }

    <div class="form-field">
        <label>Fulde navn</label>
        <input type="text" @bind="nyBruger.Navn" placeholder="Indtast navn" />
    </div>

    <div class="form-field">
        <label>Email</label>
        <input type="email" @bind="nyBruger.Mail" placeholder="user@example.com" />
    </div>

    <div class="form-field">
        <label>Telefon</label>
        <input type="text" @bind="nyBruger.tlfnr" placeholder="+45 12 34 56 78" />
    </div>

    <div class="form-field" style="flex-direction: row; align-items: center; gap: 8px;">
        <input type="checkbox" id="IsAdmin" @bind="nyBruger.IsAdmin" />
        <label for="IsAdmin">Is Admin</label>
    </div>

    <button class="submit-btn" @onclick="AddUser" disabled="@saving">Tilføj bruger</button>
</div>
</div>

@code {
    
}